<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Emoji Arena</title>
<style>
body{margin:0;overflow:hidden;background:#111;font-family:Arial}
canvas{display:block}
#ui{position:fixed;top:10px;left:10px;color:white;z-index:10}
select{padding:5px;border-radius:8px}
</style>
</head>
<body>

<div id="ui">
Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span><br>
<select id="skin">
<option value="#00ff88">Ø£Ø®Ø¶Ø±</option>
<option value="#00bfff">Ø£Ø²Ø±Ù‚</option>
<option value="#ff00ff">Ø¨Ù†ÙØ³Ø¬ÙŠ</option>
<option value="#ff4444">Ø£Ø­Ù…Ø±</option>
<option value="#ffaa00">Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ</option>
</select>
</div>

<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

const worldSize=3500;
const wall=30;
const fruits=["ğŸ","ğŸŒ","ğŸ‡","ğŸ‰","ğŸ“"];

let player,bots,foods,score,touchX,touchY;

/* ===== Ø¥Ù†Ø´Ø§Ø¡ Ø­ÙŠØ© ===== */
function createSnake(x,y,len,color,isPlayer=false){
let s={
body:[],
length:len,
speed:2,
angle:0,
color:color,
isPlayer:isPlayer
};
for(let i=0;i<len;i++) s.body.push({x:x,y:y});
return s;
}

/* ===== Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© ===== */
function startGame(){
score=0;
document.getElementById("score").innerText=score;

player=createSnake(worldSize/2,worldSize/2,40,"#00ff88",true);

foods=[];
for(let i=0;i<200;i++){
foods.push({
x:Math.random()*worldSize,
y:Math.random()*worldSize,
icon:fruits[Math.floor(Math.random()*fruits.length)]
});
}

/* Ø¨ÙˆØªØ§Øª */
bots=[];
for(let i=0;i<6;i++){
let bx=Math.random()*worldSize;
let by=Math.random()*worldSize;
let colors=["#888","#ff66ff","#66ffff","#ffff66"];
let bot=createSnake(bx,by,30,colors[i%colors.length],false);
bot.angle=Math.random()*Math.PI*2;
bots.push(bot);
}
}
startGame();

/* ===== ØªØ­ÙƒÙ… Ù„Ù…Ø³ ===== */
touchX=canvas.width/2;
touchY=canvas.height/2;

canvas.addEventListener("touchmove",e=>{
const rect=canvas.getBoundingClientRect();
touchX=e.touches[0].clientX-rect.left;
touchY=e.touches[0].clientY-rect.top;
});

/* ===== Grid ===== */
function drawGrid(camX,camY){
ctx.strokeStyle="#222";
const g=100;
for(let x=-camX%g;x<canvas.width;x+=g){
ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,canvas.height);ctx.stroke();
}
for(let y=-camY%g;y<canvas.height;y+=g){
ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(canvas.width,y);ctx.stroke();
}
}

/* ===== Ø±Ø³Ù… Ø­ÙŠØ© Ù…Ø¹ Ø³Ù…Ø§ÙŠÙ„Ø§Øª ===== */
function drawSnake(s){
for(let i=s.body.length-1;i>=0;i--){
ctx.beginPath();
ctx.fillStyle=s.color;
ctx.arc(s.body[i].x,s.body[i].y,14,0,Math.PI*2);
ctx.fill();
}

/* Ø±Ø£Ø³ */
let head=s.body[0];
ctx.beginPath();
ctx.fillStyle=s.color;
ctx.arc(head.x,head.y,18,0,Math.PI*2);
ctx.fill();

/* Ø³Ù…Ø§ÙŠÙ„ */
ctx.font="24px Arial";
ctx.textAlign="center";
ctx.textBaseline="middle";
ctx.fillText("ğŸ˜„",head.x,head.y+2);
}

/* ===== ØªØ­Ø¯ÙŠØ« Ø­ÙŠØ© ===== */
function updateSnake(s){

if(s.isPlayer){
let dx=touchX-canvas.width/2;
let dy=touchY-canvas.height/2;
s.angle=Math.atan2(dy,dx);
}else{
/* Ø°ÙƒØ§Ø¡ ØµÙ†Ø§Ø¹ÙŠ: Ø§Ù‚Ø±Ø¨ ÙØ§ÙƒÙ‡Ø© */
let nearest=foods[0];
let minDist=999999;
for(let f of foods){
let d=Math.hypot(s.body[0].x-f.x,s.body[0].y-f.y);
if(d<minDist){minDist=d;nearest=f;}
}
s.angle=Math.atan2(nearest.y-s.body[0].y,nearest.x-s.body[0].x);
}

let newHead={
x:s.body[0].x+Math.cos(s.angle)*s.speed,
y:s.body[0].y+Math.sin(s.angle)*s.speed
};

/* Ø¬Ø¯Ø§Ø± */
if(newHead.x<wall||newHead.y<wall||newHead.x>worldSize-wall||newHead.y>worldSize-wall){
if(s.isPlayer){startGame();return;}
else{s.angle+=Math.PI;return;}
}

s.body.unshift(newHead);
if(s.body.length>s.length) s.body.pop();

/* Ø£ÙƒÙ„ */
for(let f of foods){
let d=Math.hypot(newHead.x-f.x,newHead.y-f.y);
if(d<25){
s.length+=6;
if(s.isPlayer){
score++;
document.getElementById("score").innerText=score;
}
f.x=Math.random()*worldSize;
f.y=Math.random()*worldSize;
}
}
}

/* ===== Ø§Ù„Ø­Ù„Ù‚Ø© ===== */
function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);

let camX=player.body[0].x-canvas.width/2;
let camY=player.body[0].y-canvas.height/2;

drawGrid(camX,camY);

ctx.save();
ctx.translate(-camX,-camY);

/* Ø¬Ø¯Ø§Ø± */
ctx.strokeStyle="red";
ctx.lineWidth=wall;
ctx.strokeRect(0,0,worldSize,worldSize);

/* ÙÙˆØ§ÙƒÙ‡ */
ctx.font="30px Arial";
for(let f of foods){
ctx.fillText(f.icon,f.x-15,f.y+10);
}

/* ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØªØ§Øª */
for(let b of bots){
updateSnake(b);
drawSnake(b);
}

/* ØªØ­Ø¯ÙŠØ« Ù„Ø§Ø¹Ø¨ */
updateSnake(player);
player.color=document.getElementById("skin").value;
drawSnake(player);

ctx.restore();
requestAnimationFrame(draw);
}

draw();

</script>
</body>
</html>
