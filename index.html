<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Arena Pro</title>
<style>
body{margin:0;overflow:hidden;background:#111;font-family:Arial}
canvas{display:block}
#ui{
position:fixed;top:10px;left:10px;color:white;z-index:10
}
select{padding:5px;border-radius:8px}
</style>
</head>
<body>

<div id="ui">
Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span>
<br>
<select id="skin">
<option value="#00ff88">Ø£Ø®Ø¶Ø±</option>
<option value="#00bfff">Ø£Ø²Ø±Ù‚</option>
<option value="#ff00ff">Ø¨Ù†ÙØ³Ø¬ÙŠ</option>
<option value="#ff4444">Ø£Ø­Ù…Ø±</option>
<option value="#ffaa00">Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ</option>
</select>
</div>

<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

const worldSize=4000;
const wall=30;
const fruits=["ğŸ","ğŸŒ","ğŸ‡","ğŸ‰","ğŸ“"];

let player, bots, foods, score, touchX, touchY;

/* ===== Ø¥Ù†Ø´Ø§Ø¡ Ù„Ø§Ø¹Ø¨ ===== */
function createPlayer(){
return{
body:[],
length:40,
speed:2,
angle:0
}
}

/* ===== Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© ===== */
function startGame(){
score=0;
document.getElementById("score").innerText=score;

player=createPlayer();
player.body=[];
let startX=worldSize/2;
let startY=worldSize/2;
for(let i=0;i<player.length;i++){
player.body.push({x:startX,y:startY});
}

foods=[];
for(let i=0;i<150;i++){
foods.push({
x:Math.random()*worldSize,
y:Math.random()*worldSize,
icon:fruits[Math.floor(Math.random()*fruits.length)]
});
}

/* ===== Ø¨ÙˆØªØ§Øª ===== */
bots=[];
for(let b=0;b<5;b++){
let bot=createPlayer();
bot.length=30;
let bx=Math.random()*worldSize;
let by=Math.random()*worldSize;
for(let i=0;i<bot.length;i++){
bot.body.push({x:bx,y:by});
}
bot.angle=Math.random()*Math.PI*2;
bots.push(bot);
}
}
startGame();

/* ===== ØªØ­ÙƒÙ… Ù„Ù…Ø³ ===== */
touchX=canvas.width/2;
touchY=canvas.height/2;

canvas.addEventListener("touchmove",e=>{
const rect=canvas.getBoundingClientRect();
touchX=e.touches[0].clientX-rect.left;
touchY=e.touches[0].clientY-rect.top;
});

/* ===== Ø±Ø³Ù… Ø§Ù„Ø´Ø¨ÙƒØ© ===== */
function drawGrid(camX,camY){
ctx.strokeStyle="#222";
ctx.lineWidth=1;
const g=100;
for(let x=-camX%g;x<canvas.width;x+=g){
ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,canvas.height);ctx.stroke();
}
for(let y=-camY%g;y<canvas.height;y+=g){
ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(canvas.width,y);ctx.stroke();
}
}

/* ===== Ø±Ø³Ù… Ø­ÙŠØ© ===== */
function drawSnake(snake,color,isPlayer=false){
for(let i=snake.body.length-1;i>=0;i--){
ctx.beginPath();
ctx.fillStyle=color;
ctx.arc(snake.body[i].x,snake.body[i].y,14,0,Math.PI*2);
ctx.fill();
}

if(isPlayer){
let head=snake.body[0];
let r=16;

/* Ø±Ø£Ø³ Ø£Ø¨ÙŠØ¶ */
ctx.beginPath();
ctx.fillStyle="white";
ctx.arc(head.x,head.y,r,0,Math.PI*2);
ctx.fill();

/* Ø§Ù„Ø¹ÙŠÙˆÙ† */
let eyeOffset=8;
let perp=snake.angle+Math.PI/2;

let ex1=head.x+Math.cos(snake.angle)*6+Math.cos(perp)*6;
let ey1=head.y+Math.sin(snake.angle)*6+Math.sin(perp)*6;

let ex2=head.x+Math.cos(snake.angle)*6-Math.cos(perp)*6;
let ey2=head.y+Math.sin(snake.angle)*6-Math.sin(perp)*6;

/* Ø¨ÙŠØ§Ø¶ Ø§Ù„Ø¹ÙŠÙ† */
ctx.fillStyle="white";
ctx.beginPath();
ctx.arc(ex1,ey1,6,0,Math.PI*2);
ctx.arc(ex2,ey2,6,0,Math.PI*2);
ctx.fill();

/* Ø§Ù„Ø¨Ø¤Ø¨Ø¤ */
ctx.fillStyle="black";
ctx.beginPath();
ctx.arc(ex1+Math.cos(snake.angle)*2,ey1+Math.sin(snake.angle)*2,3,0,Math.PI*2);
ctx.arc(ex2+Math.cos(snake.angle)*2,ey2+Math.sin(snake.angle)*2,3,0,Math.PI*2);
ctx.fill();

/* Ø§Ù„ÙÙ… */
ctx.strokeStyle="black";
ctx.lineWidth=3;
ctx.beginPath();
ctx.arc(
head.x+Math.cos(snake.angle)*6,
head.y+Math.sin(snake.angle)*6,
8,
snake.angle+0.3,
snake.angle-0.3,
true
);
ctx.stroke();
}
}

/* ===== ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØª ===== */
function updateBot(bot){
if(Math.random()<0.02){
bot.angle+=(Math.random()-0.5);
}
let head={
x:bot.body[0].x+Math.cos(bot.angle)*1.5,
y:bot.body[0].y+Math.sin(bot.angle)*1.5
};
if(head.x<wall||head.y<wall||head.x>worldSize-wall||head.y>worldSize-wall){
bot.angle+=Math.PI;
}
bot.body.unshift(head);
if(bot.body.length>bot.length) bot.body.pop();
}

/* ===== Ø§Ù„Ø­Ù„Ù‚Ø© ===== */
function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);

let camX=player.body[0].x-canvas.width/2;
let camY=player.body[0].y-canvas.height/2;

drawGrid(camX,camY);

ctx.save();
ctx.translate(-camX,-camY);

/* Ø§Ù„Ø¬Ø¯Ø§Ø± */
ctx.strokeStyle="red";
ctx.lineWidth=wall;
ctx.strokeRect(0,0,worldSize,worldSize);

/* Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù„Ø§Ø¹Ø¨ */
let dx=touchX-canvas.width/2;
let dy=touchY-canvas.height/2;
player.angle=Math.atan2(dy,dx);

/* ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù„Ø§Ø¹Ø¨ */
let newHead={
x:player.body[0].x+Math.cos(player.angle)*player.speed,
y:player.body[0].y+Math.sin(player.angle)*player.speed
};

/* Ø§ØµØ·Ø¯Ø§Ù… Ø¬Ø¯Ø§Ø± */
if(newHead.x<wall||newHead.y<wall||newHead.x>worldSize-wall||newHead.y>worldSize-wall){
startGame();
return;
}

player.body.unshift(newHead);
if(player.body.length>player.length) player.body.pop();

/* Ø£ÙƒÙ„ */
ctx.font="30px Arial";
for(let f of foods){
ctx.fillText(f.icon,f.x-15,f.y+10);
let d=Math.hypot(newHead.x-f.x,newHead.y-f.y);
if(d<25){
player.length+=8;
score++;
document.getElementById("score").innerText=score;
f.x=Math.random()*worldSize;
f.y=Math.random()*worldSize;
}
}

/* ØªØ­Ø¯ÙŠØ« Ø¨ÙˆØªØ§Øª */
for(let bot of bots){
updateBot(bot);
drawSnake(bot,"#888");
}

/* Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ */
let skin=document.getElementById("skin").value;
drawSnake(player,skin,true);

ctx.restore();
requestAnimationFrame(draw);
}

draw();

</script>
</body>
</html>
