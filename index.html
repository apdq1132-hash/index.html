<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Snake Lite Pro - Offline</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #121212; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; touch-action: none; }
        canvas { display: block; background-image: radial-gradient(#2a2a2a 1px, transparent 1px); background-size: 40px 40px; }
        #ui { position: absolute; top: 20px; left: 20px; color: white; pointer-events: none; }
        .stat { background: rgba(0,0,0,0.6); padding: 10px 20px; border-radius: 20px; margin-bottom: 5px; border: 1px solid #444; }
        #instructions { position: absolute; bottom: 20px; width: 100%; text-align: center; color: #888; font-size: 14px; }
    </style>
</head>
<body>

<div id="ui">
    <div class="stat" id="score">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
    <div class="stat" id="rank">Ø§Ù„ØªØ±ØªÙŠØ¨: #1</div>
</div>
<div id="instructions">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø§Ù„Ù„Ù…Ø³ Ù„Ù„ØªØ­Ø±Ùƒ â€¢ Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ù„Ù„ØªØ³Ø±ÙŠØ¹ âš¡</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let mouse = { x: canvas.width / 2, y: canvas.height / 2, pressed: false };
let score = 0;

class Snake {
    constructor(x, y, color, emoji, isPlayer) {
        this.segments = [];
        for(let i=0; i<15; i++) this.segments.push({x, y});
        this.color = color;
        this.emoji = emoji;
        this.radius = 15;
        this.angle = Math.random() * Math.PI * 2;
        this.speed = 3;
        this.isPlayer = isPlayer;
        this.maxLength = 20;
    }

    draw() {
        // Ø±Ø³Ù… Ø§Ù„Ø¬Ø³Ù…
        for (let i = this.segments.length - 1; i >= 0; i--) {
            ctx.beginPath();
            ctx.fillStyle = this.color;
            ctx.globalAlpha = 1 - (i / this.segments.length * 0.5);
            let size = this.radius - (i * 0.3 > 8 ? 8 : i * 0.3);
            ctx.arc(this.segments[i].x, this.segments[i].y, size, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø¥Ø¶Ø§ÙØ© Ù„Ù…Ø¹Ø© Ù„Ù„Ø¬Ø³Ù…
            if (i % 3 === 0) {
                ctx.fillStyle = "white";
                ctx.globalAlpha = 0.2;
                ctx.arc(this.segments[i].x - 3, this.segments[i].y - 3, size/3, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Ø±Ø³Ù… Ø§Ù„Ø±Ø£Ø³ (Ø§Ù„ÙˆØ¬Ù‡ Ø§Ù„Ø¶Ø§Ø­Ùƒ)
        ctx.save();
        ctx.globalAlpha = 1;
        ctx.translate(this.segments[0].x, this.segments[0].y);
        ctx.rotate(this.angle + Math.PI/2);
        ctx.font = `${this.radius * 2.5}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(this.emoji, 0, 0);
        ctx.restore();
    }

    update() {
        let head = { ...this.segments[0] };
        
        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø±Ø¹Ø© (Boost)
        let currentSpeed = (this.isPlayer && mouse.pressed && this.maxLength > 10) ? this.speed * 2 : this.speed;
        if (this.isPlayer && mouse.pressed && this.maxLength > 10) this.maxLength -= 0.1; // ÙŠÙ‚Ù„ Ø§Ù„Ø·ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ø±ÙŠØ¹

        if (this.isPlayer) {
            let targetAngle = Math.atan2(mouse.y - head.y, mouse.x - head.x);
            let diff = targetAngle - this.angle;
            while (diff < -Math.PI) diff += Math.PI * 2;
            while (diff > Math.PI) diff -= Math.PI * 2;
            this.angle += diff * 0.1;
        } else {
            if (Math.random() < 0.02) this.angle += (Math.random() - 0.5) * 2;
        }

        head.x += Math.cos(this.angle) * currentSpeed;
        head.y += Math.sin(this.angle) * currentSpeed;

        this.segments.unshift(head);
        if (this.segments.length > this.maxLength) this.segments.pop();

        // Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ø§Ø´Ø©
        if (head.x < 0) head.x = canvas.width;
        if (head.x > canvas.width) head.x = 0;
        if (head.y < 0) head.y = canvas.height;
        if (head.y > canvas.height) head.y = 0;
    }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø¨ÙˆØ¬ÙˆÙ‡ Ù…Ø®ØªÙ„ÙØ©
let player = new Snake(canvas.width/2, canvas.height/2, '#4CAF50', 'ğŸŸ¢', true); // ÙˆØ¬Ù‡ Ø£Ø®Ø¶Ø±
let enemies = [
    new Snake(100, 100, '#F44336', 'ğŸ”´', false),
    new Snake(500, 100, '#2196F3', 'ğŸ”µ', false),
    new Snake(300, 400, '#9C27B0', 'ğŸŸ£', false),
    new Snake(600, 500, '#FF9800', 'ğŸŸ ', false)
];

let food = [];
function spawnFood() {
    const treats = ['ğŸ', 'ğŸ¬', 'ğŸ©', 'ğŸ•', 'ğŸ“'];
    if (food.length < 60) {
        food.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            item: treats[Math.floor(Math.random() * treats.length)],
            size: Math.random() * 10 + 15
        });
    }
}

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    spawnFood();

    // Ø±Ø³Ù… Ø§Ù„Ø·Ø¹Ø§Ù…
    food.forEach((f, index) => {
        ctx.font = `${f.size}px Arial`;
        ctx.fillText(f.item, f.x, f.y);
        
        let dist = Math.hypot(player.segments[0].x - f.x, player.segments[0].y - f.y);
        if (dist < 30) {
            food.splice(index, 1);
            player.maxLength += 3;
            score += 10;
            document.getElementById('score').innerText = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}`;
        }
    });

    // ØªØ­Ø¯ÙŠØ« ÙˆØ±Ø³Ù… Ø§Ù„Ø«Ø¹Ø§Ø¨ÙŠÙ†
    [player, ...enemies].forEach(s => {
        s.update();
        s.draw();
    });

    // ØªØµØ§Ø¯Ù… (Ø¨Ø³ÙŠØ·)
    enemies.forEach(en => {
        let dist = Math.hypot(player.segments[0].x - en.segments[0].x, player.segments[0].y - en.segments[0].y);
        if (dist < 25) {
            score = 0;
            player.maxLength = 20;
            player.segments = [{x: canvas.width/2, y: canvas.height/2}];
        }
    });

    requestAnimationFrame(animate);
}

// Ø§Ù„ØªØ­ÙƒÙ…
const updateMouse = (e) => {
    mouse.x = e.clientX || e.touches[0].clientX;
    mouse.y = e.clientY || e.touches[0].clientY;
};
window.addEventListener('mousemove', updateMouse);
window.addEventListener('touchmove', updateMouse);
window.addEventListener('mousedown', () => mouse.pressed = true);
window.addEventListener('mouseup', () => mouse.pressed = false);
window.addEventListener('touchstart', () => mouse.pressed = true);
window.addEventListener('touchend', () => mouse.pressed = false);

animate();
</script>
</body>
</html>
