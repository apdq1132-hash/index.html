<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Arena</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:#111;
}
canvas{
    display:block;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let snake = [];
let length = 40;
let angle = 0;
let speed = 2;
let foods = [];
let score = 0;

for(let i=0;i<length;i++){
    snake.push({x:canvas.width/2,y:canvas.height/2});
}

for(let i=0;i<80;i++){
    foods.push({
        x:Math.random()*canvas.width,
        y:Math.random()*canvas.height,
        color:`hsl(${Math.random()*360},100%,50%)`
    });
}

let touchX = canvas.width/2;
let touchY = canvas.height/2;

canvas.addEventListener("touchmove", e=>{
    const rect = canvas.getBoundingClientRect();
    touchX = e.touches[0].clientX - rect.left;
    touchY = e.touches[0].clientY - rect.top;
});

function draw(){
    ctx.fillStyle="#111";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // زاوية الحركة
    let dx = touchX - snake[0].x;
    let dy = touchY - snake[0].y;
    angle = Math.atan2(dy,dx);

    // تحريك الرأس
    let head = {
        x: snake[0].x + Math.cos(angle)*speed,
        y: snake[0].y + Math.sin(angle)*speed
    };

    snake.unshift(head);
    if(snake.length > length) snake.pop();

    // رسم الأكل
    for(let i=0;i<foods.length;i++){
        ctx.beginPath();
        ctx.fillStyle = foods[i].color;
        ctx.arc(foods[i].x,foods[i].y,6,0,Math.PI*2);
        ctx.fill();

        let dist = Math.hypot(head.x - foods[i].x, head.y - foods[i].y);
        if(dist < 10){
            length += 5;
            score++;
            foods[i].x = Math.random()*canvas.width;
            foods[i].y = Math.random()*canvas.height;
        }
    }

    // رسم الحية
    for(let i=snake.length-1;i>=0;i--){
        ctx.beginPath();
        ctx.fillStyle = i===0 ? "#ffffff" : "#00ff88";
        ctx.arc(snake[i].x,snake[i].y,8,0,Math.PI*2);
        ctx.fill();
    }

    requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>
